{"version":3,"sources":["../source/SegmentedControl.js"],"names":["Segmented_control","state","on_key_down","bind","fallback","props","setState","javascript","disabled","options","indicateInvalid","error","style","className","markup","map","option","index","render_button","render_static","value","selected","first","last","length","ref","undefined","chooser","label","render_static_option","name","event","onChange","previous_value","findDOMNode","button_0","focus","ctrlKey","altKey","shiftKey","metaKey","keyCode","preventDefault","previous_option_index","next_option_index","i","propTypes","arrayOf","shape","string","isRequired","bool","any","func","object","defaultProps"],"mappings":"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","file":"SegmentedControl.js","sourcesContent":["import React, { PureComponent } from 'react'\r\nimport PropTypes from 'prop-types'\r\nimport ReactDOM from 'react-dom'\r\nimport classNames from 'classnames'\r\n\r\nexport default class Segmented_control extends PureComponent\r\n{\r\n\tstate = {}\r\n\r\n\tstatic propTypes =\r\n\t{\r\n\t\t// A list of selectable options\r\n\t\toptions : PropTypes.arrayOf\r\n\t\t(\r\n\t\t\tPropTypes.shape\r\n\t\t\t({\r\n\t\t\t\t// Option value\r\n\t\t\t\tvalue: PropTypes.string.isRequired,\r\n\t\t\t\t// Option label\r\n\t\t\t\tlabel: PropTypes.string.isRequired\r\n\t\t\t})\r\n\t\t)\r\n\t\t.isRequired,\r\n\r\n\t\t// HTML form input `name` attribute\r\n\t\tname         : PropTypes.string,\r\n\r\n\t\t// If `true` then will be disabled\r\n\t\tdisabled     : PropTypes.bool,\r\n\r\n\t\t// The selected option value\r\n\t\tvalue        : PropTypes.any,\r\n\r\n\t\t// Is called when an option is selected\r\n\t\tonChange     : PropTypes.func.isRequired,\r\n\r\n\t\t// (exotic use case)\r\n\t\t// Falls back to a plain HTML input\r\n\t\t// when javascript is disabled (e.g. Tor)\r\n\t\tfallback  : PropTypes.bool.isRequired,\r\n\r\n\t\t// CSS class\r\n\t\tclassName    : PropTypes.string,\r\n\r\n\t\t// CSS style object\r\n\t\tstyle        : PropTypes.object\r\n\t}\r\n\r\n\tstatic defaultProps =\r\n\t{\r\n\t\tfallback : false\r\n\t}\r\n\r\n\tconstructor()\r\n\t{\r\n\t\tsuper()\r\n\r\n\t\tthis.on_key_down = this.on_key_down.bind(this)\r\n\t}\r\n\r\n\t// Client side rendering, javascript is enabled\r\n\tcomponentDidMount()\r\n\t{\r\n\t\tconst { fallback } = this.props\r\n\r\n\t\tif (fallback)\r\n\t\t{\r\n\t\t\tthis.setState({ javascript: true })\r\n\t\t}\r\n\t}\r\n\r\n\trender()\r\n\t{\r\n\t\tconst\r\n\t\t{\r\n\t\t\tdisabled,\r\n\t\t\toptions,\r\n\t\t\tfallback,\r\n\t\t\tindicateInvalid,\r\n\t\t\terror,\r\n\t\t\tstyle,\r\n\t\t\tclassName\r\n\t\t}\r\n\t\t= this.props\r\n\r\n\t\tconst markup =\r\n\t\t(\r\n\t\t\t<div\r\n\t\t\t\tonKeyDown={ this.on_key_down }\r\n\t\t\t\tclassName={ classNames('rrui__segmented-control',\r\n\t\t\t\t{\r\n\t\t\t\t\t'rrui__rich'                        : fallback,\r\n\t\t\t\t\t'rrui__segmented-control--disabled' : disabled\r\n\t\t\t\t},\r\n\t\t\t\tclassName) }\r\n\t\t\t\tstyle={ style }>\r\n\r\n\t\t\t\t<div className=\"rrui__input\">\r\n\t\t\t\t\t{ options.map((option, index) => this.render_button(option, index)) }\r\n\t\t\t\t</div>\r\n\r\n\t\t\t\t{ fallback && !this.state.javascript && this.render_static() }\r\n\r\n\t\t\t\t{ indicateInvalid && error && <div className=\"rrui__input-error\">{ error }</div> }\r\n\t\t\t</div>\r\n\t\t)\r\n\r\n\t\treturn markup\r\n\t}\r\n\r\n\trender_button(option, index)\r\n\t{\r\n\t\tconst { options, value, disabled } = this.props\r\n\r\n\t\tconst selected = value === option.value\r\n\r\n\t\tconst first = index === 0\r\n\t\tconst last  = index === options.length - 1\r\n\r\n\t\tconst markup =\r\n\t\t(\r\n\t\t\t<button\r\n\t\t\t\tkey={ option.value }\r\n\t\t\t\tref={ ref => this[`button_${index}`] = ref }\r\n\t\t\t\ttype=\"button\"\r\n\t\t\t\ttabIndex={ index === 0 ? undefined : '-1' }\r\n\t\t\t\tdisabled={ disabled }\r\n\t\t\t\tonClick={ this.chooser(option.value) }\r\n\t\t\t\tclassName={ classNames\r\n\t\t\t\t(\r\n\t\t\t\t\t'rrui__button-reset',\r\n\t\t\t\t\t'rrui__segmented-control__option',\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t'rrui__segmented-control__option--selected' : selected,\r\n\t\t\t\t\t\t// CSS selector performance optimization\r\n\t\t\t\t\t\t'rrui__segmented-control__option--disabled' : disabled,\r\n\t\t\t\t\t\t// Ordering\r\n\t\t\t\t\t\t'rrui__segmented-control__option--first'    : first,\r\n\t\t\t\t\t\t'rrui__segmented-control__option--last'     : last,\r\n\t\t\t\t\t\t'rrui__segmented-control__option--middle'   : !first && !last\r\n\t\t\t\t\t}\r\n\t\t\t\t) }>\r\n\t\t\t\t{ option.label }\r\n\t\t\t</button>\r\n\t\t)\r\n\r\n\t\treturn markup\r\n\t}\r\n\r\n\t// supports disabled javascript\r\n\trender_static()\r\n\t{\r\n\t\tconst { options } = this.props\r\n\r\n\t\tconst markup =\r\n\t\t(\r\n\t\t\t<div className=\"rrui__rich__fallback\">\r\n\t\t\t\t{ options.map((option, index) => this.render_static_option(option, index)) }\r\n\t\t\t</div>\r\n\t\t)\r\n\r\n\t\treturn markup\r\n\t}\r\n\r\n\trender_static_option(option, index)\r\n\t{\r\n\t\tconst { options, name, value } = this.props\r\n\r\n\t\tconst first = index === 0\r\n\t\tconst last  = index === options.length - 1\r\n\r\n\t\tconst markup =\r\n\t\t(\r\n\t\t\t<span\r\n\t\t\t\tkey={ option.value }\r\n\t\t\t\tclassName={ classNames('rrui__button-reset', 'rrui__segmented-control__option',\r\n\t\t\t\t{\r\n\t\t\t\t\t'rrui__segmented-control__option--first'  : first,\r\n\t\t\t\t\t'rrui__segmented-control__option--last'   : last,\r\n\t\t\t\t\t'rrui__segmented-control__option--middle' : !first && !last\r\n\t\t\t\t}) }>\r\n\t\t\t\t<input\r\n\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\tname={ name }\r\n\t\t\t\t\tchecked={ value === option.value }/>\r\n\t\t\t\t{ option.label }\r\n\t\t\t</span>\r\n\t\t)\r\n\r\n\t\treturn markup\r\n\t}\r\n\r\n\tchooser(value)\r\n\t{\r\n\t\treturn (event) =>\r\n\t\t{\r\n\t\t\tconst { disabled, onChange, value: previous_value } = this.props\r\n\r\n\t\t\tif (disabled)\r\n\t\t\t{\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\r\n\t\t\t// Call `onChange` only if `value` did actually change\r\n\t\t\tif (value !== previous_value)\r\n\t\t\t{\r\n\t\t\t\tonChange(value)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfocus()\r\n\t{\r\n\t\tReactDOM.findDOMNode(this.button_0).focus()\r\n\t}\r\n\r\n\ton_key_down(event)\r\n\t{\r\n\t\tif (event.ctrlKey || event.altKey || event.shiftKey || event.metaKey)\r\n\t\t{\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tconst { onChange, options } = this.props\r\n\r\n\t\tswitch (event.keyCode)\r\n\t\t{\r\n\t\t\t// Select the previous option (if present) on left arrow\r\n\t\t\tcase 37:\r\n\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\tconst previous_option_index = this.previous_option_index()\r\n\r\n\t\t\t\tif (previous_option_index !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\t// Focus the option <button/> so that\r\n\t\t\t\t\t// a subsequent \"Spacebar\" keyDown\r\n\t\t\t\t\t// doesn't select the previously selected\r\n\t\t\t\t\t// option (e.g. the first one)\r\n\t\t\t\t\tthis[`button_${previous_option_index}`].focus()\r\n\r\n\t\t\t\t\t// Change the `value`\r\n\t\t\t\t\treturn onChange(options[previous_option_index].value)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\r\n\r\n\t\t\t// Select the next option (if present) on right arrow\r\n\t\t\tcase 39:\r\n\t\t\t\tevent.preventDefault()\r\n\r\n\t\t\t\tconst next_option_index = this.next_option_index()\r\n\r\n\t\t\t\tif (next_option_index !== undefined)\r\n\t\t\t\t{\r\n\t\t\t\t\t// Focus the option <button/> so that\r\n\t\t\t\t\t// a subsequent \"Spacebar\" keyDown\r\n\t\t\t\t\t// doesn't select the previously selected\r\n\t\t\t\t\t// option (e.g. the first one)\r\n\t\t\t\t\tthis[`button_${next_option_index}`].focus()\r\n\r\n\t\t\t\t\t// Change the `value`\r\n\t\t\t\t\treturn onChange(options[next_option_index].value)\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn\r\n\t\t}\r\n\t}\r\n\r\n\t// Get the previous option index (relative to the currently selected option)\r\n\tprevious_option_index()\r\n\t{\r\n\t\tconst { options, value } = this.props\r\n\r\n\t\tlet i = 0\r\n\t\twhile (i < options.length)\r\n\t\t{\r\n\t\t\tif (options[i].value === value)\r\n\t\t\t{\r\n\t\t\t\tif (i - 1 >= 0)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn i - 1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t}\r\n\r\n\t// Get the next option index (relative to the currently selected option)\r\n\tnext_option_index()\r\n\t{\r\n\t\tconst { options, value } = this.props\r\n\r\n\t\tlet i = 0\r\n\t\twhile (i < options.length)\r\n\t\t{\r\n\t\t\tif (options[i].value === value)\r\n\t\t\t{\r\n\t\t\t\tif (i + 1 < options.length)\r\n\t\t\t\t{\r\n\t\t\t\t\treturn i + 1\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\ti++\r\n\t\t}\r\n\t}\r\n}"]}